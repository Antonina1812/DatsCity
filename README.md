# DatsCity

## Описание игры

Игрокам необходимо построить башни из слов и набрать за них как можно больше баллов.

Игра проходит в несколько раундов, каждый из которых состоит из ходов.

В один ход игроки могут:

•   Завершить старую башню
•   Начать новую башню
•   Продолжать достраивать новую башню
•   Завершить новую башню

Незавершённая башня переходит на следующий ход, где её можно достраивать. Таким образом, к концу игры у команды может быть множество башен, баллы за которые будут суммироваться.

Команда на каждый ход получает рандомный набор из 1000 слов. Этот набор одинаков для всех команд. По желанию команда может запросить новый набор слов в текущем ходу. Он будет уникален, но с меньшим количеством слов.

## Терминология

•   **Ход** – промежуток времени, в течение которого команда может построить или достроить часть башни.
•   **Раунд** – набор ходов. Каждый раунд игроки начинают с нуля, не имея построек с прошлых раундов.
•   **Тестовые раунды** – раунды, счёт за которые не учитывается при подсчёте очков для победы.
•   **Финальные раунды** – раунды, счёт за которые учитывается при подсчёте очков для победы.

## Механика игры

### Получение набора слов

•   На каждый ход команда получает набор из 1000 слов, который доступен только на этот ход.
•   Слова в наборе могут быть не уникальными, но каждое слово имеет свой id и его можно использовать только 1 раз.
•   Первый набор слов в ходу одинаков для всех.
•   Команда имеет возможность несколько раз получить новый рандомный набор слов в каждом ходу. Новый набор уже уникален для каждой команды. Каждый запрос нового набора уменьшает количество слов в нём на 100.
•   Новые наборы можно запросить только если в текущем ходу ничего не было построено – старое или новое.

### Устойчивость башни

•   Любое вертикальное слово должно иметь пересечения минимум с 2 горизонтальными словами.
•   Любое горизонтальное слово должно иметь пересечения минимум с 2 вертикальными словами.
•   Пересечения в 1-ой букве не учитываются.
•   Исключением являются горизонтальные слова на 0 этаже – они могут не иметь пересечений с вертикальными словами.
•   Башня должна иметь минимум 2 этажа.

### Правила строительства башни

•   Каждая башня располагается в своём собственном пространстве со стартовой точкой `[0, 0, 0]` и ограниченным размерами, полученными по API.
•   Пространство одной башни никак не связано с другими, в которых находятся другие башни.
•   Башню можно располагать только в положительных осях координат XYZ.
•   По Х и У слова могут располагаться только в положительном направлении оси координат.
•   По Z слова могут располагаться только в отрицательном направлении оси координат.
•   Первый этаж башни должен находиться на 0 координате Z.
•   Два или более слов могут пересекаться только перпендикулярно друг другу и должны иметь одну общую одинаковую букву.
•   Нельзя расположить 2 и более слов последовательно или перпендикулярно, без разрыва между ними хотя бы в 1 клетку.
•   Исключением запрета на расположение двух слов без разрыва в 1 клетку является ситуация, когда два слова расположены в разных направлениях или ребром друг к другу.
•   Нельзя располагать слова в разрыве друг от друга.
•   Нельзя располагать 2 слова последовательно, даже если они имеют одну общую букву.

### Начало стройки башни

Начать строительство новой башни можно только в двух случаях:

•   На начало хода у команды нет текущей строящейся башни.
•   После завершения текущей стройки башни, основанной на предыдущем ходу.

### Завершение стройки башни

Если команда видит, что продолжать строительство текущей башни невыгодно, она может её завершить. Завершённую башню достраивать нельзя.

В один ход можно 2 раза завершить башню: старую и построенную в этом ходу.

Описание API

/api/build - Строит или достраивает башню. В случае продолжения строительства башни, нужно отправлять только новые слова.
Входные параметры:
done – завершение строительства. В один запрос можно построить и сразу завершить башню.
words – список слов
words.dir – направление
1 = [0, 0, -1]
2 = [1, 0, 0]
3 = [0, 1, 0]
words.id – идентификатор (он же индекс) слова
words.pos – координата первой буквы слова
/api/shuffle – Возвращает новый набор слов
/api/towers – Возвращает:
Завершённые башни
Набранные баллы
Текущую строящуюся башню и её баллы
/api/words - Возвращает:
mapSize – размер пространства строительства башни по XYZ
nextTurnSec – время до следующего хода в секундах
roundEndsAt – время завершения раунда
shuffleLeft – оставшиеся попытки получения новых слов
turn – номер текущего хода
usedIndexes – список id использованных слов
words – набор слов для текущего хода
/api/rounds – Возвращает расписание раундов

# DatsCity API Documentation

This document describes the API endpoints for the DatsCity game.

## Endpoints

### `/api/build` - Строит или достраивает башню. В случае продолжения строительства башни, нужно отправлять только новые слова.

Входные параметры:
done – завершение строительства. В один запрос можно построить и сразу завершить башню.
words – список слов
words.dir – направление
1 = [0, 0, -1]
2 = [1, 0, 0]
3 = [0, 1, 0]
words.id – идентификатор (он же индекс) слова
words.pos – координата первой буквы слова

### `/api/shuffle` – Возвращает новый набор слов
### `/api/towers` – Возвращает:
Завершённые башни
Набранные баллы
Текущую строящуюся башню и её баллы
### `/api/words` - Возвращает:
mapSize – размер пространства строительства башни по XYZ
nextTurnSec – время до следующего хода в секундах
roundEndsAt – время завершения раунда
shuffleLeft – оставшиеся попытки получения новых слов
turn – номер текущего хода
usedIndexes – список id использованных слов
words – набор слов для текущего хода
### `/api/rounds` – Возвращает расписание раундов